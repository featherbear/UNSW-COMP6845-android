(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))f(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&f(n)}).observe(document,{childList:!0,subtree:!0});function s(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function f(o){if(o.ep)return;o.ep=!0;const r=s(o);fetch(o.href,r)}})();function S(){}function Ne(t){return t()}function Ie(){return Object.create(null)}function ve(t){t.forEach(Ne)}function Qe(t){return typeof t=="function"}function ee(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Be(t){return Object.keys(t).length===0}const Fe=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function H(t,e){t.appendChild(e)}function l(t,e,s){t.insertBefore(e,s||null)}function i(t){t.parentNode&&t.parentNode.removeChild(t)}function Re(t,e){for(let s=0;s<t.length;s+=1)t[s]&&t[s].d(e)}function a(t){return document.createElement(t)}function ne(t){return document.createTextNode(t)}function m(){return ne(" ")}function $e(){return ne("")}function qe(t,e,s,f){return t.addEventListener(e,s,f),()=>t.removeEventListener(e,s,f)}function oe(t,e,s){s==null?t.removeAttribute(e):t.getAttribute(e)!==s&&t.setAttribute(e,s)}function Ge(t){return Array.from(t.childNodes)}function Ce(t,e){e=""+e,t.data!==e&&(t.data=e)}function Pe(t,e,s){t.classList[s?"add":"remove"](e)}function Me(t,e){return new t(e)}let ye;function he(t){ye=t}function ze(){if(!ye)throw new Error("Function called outside component initialization");return ye}function Ze(t){ze().$$.on_mount.push(t)}const me=[],we=[];let be=[];const Se=[],Ue=Promise.resolve();let xe=!1;function Ye(){xe||(xe=!0,Ue.then(je))}function He(t){be.push(t)}function Je(t){Se.push(t)}const Te=new Set;let ce=0;function je(){if(ce!==0)return;const t=ye;do{try{for(;ce<me.length;){const e=me[ce];ce++,he(e),Ke(e.$$)}}catch(e){throw me.length=0,ce=0,e}for(he(null),me.length=0,ce=0;we.length;)we.pop()();for(let e=0;e<be.length;e+=1){const s=be[e];Te.has(s)||(Te.add(s),s())}be.length=0}while(me.length);for(;Se.length;)Se.pop()();xe=!1,Te.clear(),he(t)}function Ke(t){if(t.fragment!==null){t.update(),ve(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(He)}}function Ve(t){const e=[],s=[];be.forEach(f=>t.indexOf(f)===-1?e.push(f):s.push(f)),s.forEach(f=>f()),be=e}const Le=new Set;let ue;function ke(){ue={r:0,c:[],p:ue}}function Ae(){ue.r||ve(ue.c),ue=ue.p}function B(t,e){t&&t.i&&(Le.delete(t),t.i(e))}function g(t,e,s,f){if(t&&t.o){if(Le.has(t))return;Le.add(t),ue.c.push(()=>{Le.delete(t),f&&(s&&t.d(1),f())}),t.o(e)}else f&&f()}function Xe(t,e,s){const f=t.$$.props[e];f!==void 0&&(t.$$.bound[f]=s,s(t.$$.ctx[f]))}function _e(t){t&&t.c()}function de(t,e,s,f){const{fragment:o,after_update:r}=t.$$;o&&o.m(e,s),f||He(()=>{const n=t.$$.on_mount.map(Ne).filter(Qe);t.$$.on_destroy?t.$$.on_destroy.push(...n):ve(n),t.$$.on_mount=[]}),r.forEach(He)}function pe(t,e){const s=t.$$;s.fragment!==null&&(Ve(s.after_update),ve(s.on_destroy),s.fragment&&s.fragment.d(e),s.on_destroy=s.fragment=null,s.ctx=[])}function ge(t,e){t.$$.dirty[0]===-1&&(me.push(t),Ye(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function te(t,e,s,f,o,r,n,b=[-1]){const u=ye;he(t);const _=t.$$={fragment:null,ctx:[],props:r,update:S,not_equal:o,bound:Ie(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:Ie(),dirty:b,skip_bound:!1,root:e.target||u.$$.root};n&&n(_.root);let h=!1;if(_.ctx=s?s(t,e.props||{},(w,y,...L)=>{const v=L.length?L[0]:y;return _.ctx&&o(_.ctx[w],_.ctx[w]=v)&&(!_.skip_bound&&_.bound[w]&&_.bound[w](v),h&&ge(t,w)),y}):[],_.update(),h=!0,ve(_.before_update),_.fragment=f?f(_.ctx):!1,e.target){if(e.hydrate){const w=Ge(e.target);_.fragment&&_.fragment.l(w),w.forEach(i)}else _.fragment&&_.fragment.c();e.intro&&B(t.$$.fragment),de(t,e.target,e.anchor,e.customElement),je()}he(u)}class ie{$destroy(){pe(this,1),this.$destroy=S}$on(e,s){if(!Qe(s))return S;const f=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return f.push(s),()=>{const o=f.indexOf(s);o!==-1&&f.splice(o,1)}}$set(e){this.$$set&&!Be(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function et(t){let e,s,f,o=`<code class="language-undefined">Version: 1.1 (20240708)
Maintainer: Andrew Wong (andrew.j.wong@unsw.edu.au)</code>`,r,n,b='<code class="language-undefined">Special thanks to Wesley Lacy for providing the lesson plan and resources</code>',u,_;return{c(){e=a("h1"),e.textContent="COMP6845 | Android Forensics",s=m(),f=a("pre"),r=m(),n=a("pre"),u=m(),_=a("p"),_.innerHTML=`Let’s dig into performing forensic analysis of an Android device!<br/>
The device used in the lab is a Google Pixel 6 Pro, and was seized by the Western Australian Police (Perth) during a suspected ‘fruit’ dealing.<br/>
You’ve been engaged to gather any intelligence on the phone, and to report back findings.`,oe(f,"class","language-undefined"),oe(n,"class","language-undefined")},m(h,w){l(h,e,w),l(h,s,w),l(h,f,w),f.innerHTML=o,l(h,r,w),l(h,n,w),n.innerHTML=b,l(h,u,w),l(h,_,w)},p:S,i:S,o:S,d(h){h&&i(e),h&&i(s),h&&i(f),h&&i(r),h&&i(n),h&&i(u),h&&i(_)}}}class tt extends ie{constructor(e){super(),te(this,e,null,et,ee,{})}}function Ee(t){let e,s,f=t[0][t[1]-1][0]+"",o,r,n,b;return{c(){e=a("button"),s=ne("« "),o=ne(f),r=ne(" «")},m(u,_){l(u,e,_),H(e,s),H(e,o),H(e,r),n||(b=qe(e,"click",t[7]),n=!0)},p(u,_){_&3&&f!==(f=u[0][u[1]-1][0]+"")&&Ce(o,f)},d(u){u&&i(e),n=!1,b()}}}function We(t){let e,s,f=t[0][t[1]+1][0]+"",o,r,n,b;return{c(){e=a("button"),s=ne("» "),o=ne(f),r=ne(" »")},m(u,_){l(u,e,_),H(e,s),H(e,o),H(e,r),n||(b=qe(e,"click",t[8]),n=!0)},p(u,_){_&3&&f!==(f=u[0][u[1]+1][0]+"")&&Ce(o,f)},d(u){u&&i(e),n=!1,b()}}}function it(t){let e,s,f,o,r,n,b=t[0][t[1]][0]+"",u,_,h,w,y,L=t[1]>0&&Ee(t),v=t[1]<t[0].length-1&&We(t);return{c(){e=a("div"),s=a("div"),f=a("div"),L&&L.c(),o=m(),r=a("div"),n=a("h4"),u=ne(b),_=m(),h=a("div"),v&&v.c(),w=m(),y=a("hr"),oe(f,"class","svelte-14sokvu"),oe(r,"class","svelte-14sokvu"),oe(h,"class","svelte-14sokvu"),oe(s,"class","navigation svelte-14sokvu"),oe(y,"class","svelte-14sokvu"),Pe(y,"wide",t[3]),oe(e,"class","container svelte-14sokvu")},m(T,x){l(T,e,x),H(e,s),H(s,f),L&&L.m(f,null),H(s,o),H(s,r),H(r,n),H(n,u),H(s,_),H(s,h),v&&v.m(h,null),H(e,w),H(e,y),t[9](e)},p(T,[x]){T[1]>0?L?L.p(T,x):(L=Ee(T),L.c(),L.m(f,null)):L&&(L.d(1),L=null),x&3&&b!==(b=T[0][T[1]][0]+"")&&Ce(u,b),T[1]<T[0].length-1?v?v.p(T,x):(v=We(T),v.c(),v.m(h,null)):v&&(v.d(1),v=null),x&8&&Pe(y,"wide",T[3])},i:S,o:S,d(T){T&&i(e),L&&L.d(),v&&v.d(),t[9](null)}}}function lt(t,e,s){let{items:f=[]}=e,{activeItem:o}=e,r=0,n,b,u,_;Ze(()=>{new IntersectionObserver(([L])=>s(3,_=L.intersectionRatio<1),{threshold:[1]}).observe(u)});const h=()=>{s(1,r--,r)},w=()=>{s(1,r++,r)};function y(L){we[L?"unshift":"push"](()=>{u=L,s(2,u)})}return t.$$set=L=>{"items"in L&&s(0,f=L.items),"activeItem"in L&&s(4,o=L.activeItem)},t.$$.update=()=>{t.$$.dirty&115&&(n!==o&&(s(5,n=o),s(1,r=f.findIndex(([L,v])=>v===o))),b!==r&&(s(6,b=r),s(4,o=f[r][1])))},[f,r,u,_,o,n,b,h,w,y]}class st extends ie{constructor(e){super(),te(this,e,lt,it,ee,{items:0,activeItem:4})}}function ot(t){let e,s,f,o,r,n,b,u,_,h,w,y,L,v,T,x,E,F,Q,R,$,G,q,z,W,Z,O,U,C,Y,I,J,j,K,D,V,P,X,N,c,k,fe,le,re,se;return{c(){e=a("h2"),e.textContent="Resources",s=m(),f=a("h3"),f.textContent="Device Image",o=m(),r=a("p"),r.innerHTML=`Download: <a href="https://drive.google.com/file/d/1ZTEuo2CT7rCGwZY1W_ZqO9Ljhx4eV073/view?usp=drive_link" rel="nofollow">Android Image - 2023-05-09 12-15-59.zip</a><br/>
Type: Logical Image<br/>
md5sum: <code>22a2f4f662a0545ca51dcf1095df2373</code><br/>
sha1sum: <code>30383a139b50bcf24b4c1f511fe7c4bc7e9a989b</code>`,n=m(),b=a("blockquote"),b.innerHTML="<p>Do you remember what the difference is between a Logical Image, a File System Image, and a Physical Image?</p>",u=m(),_=a("hr"),h=m(),w=a("h3"),w.textContent="SQLite Browser (or an SQL browser of choice)",y=m(),L=a("blockquote"),L.innerHTML="<p>A desktop tool to analyse SQLite files (as well as SQLCipher used in this lab)</p>",v=m(),T=a("p"),T.innerHTML='Download: <a href="https://sqlitebrowser.org/dl/" rel="nofollow">sqlitebrowser.org</a>',x=m(),E=a("hr"),F=m(),Q=a("h3"),Q.textContent="HxD (or a hex editor of choice)",R=m(),$=a("blockquote"),$.innerHTML="<p>A hex editor</p>",G=m(),q=a("p"),q.innerHTML='Download: <a href="https://mh-nexus.de/en/hxd/" rel="nofollow">mh-nexus.de</a>',z=m(),W=a("hr"),Z=m(),O=a("h3"),O.textContent="ALEAPP (optional)",U=m(),C=a("blockquote"),C.innerHTML="<p>ALEAPP is a forensics tool to analyse the contents of an Android device</p>",Y=m(),I=a("p"),I.innerHTML=`GitHub: <a href="https://github.com/abrignoni/ALEAPP" rel="nofollow">abrignoni/ALEAPP</a><br/>
Download: <a href="https://github.com/abrignoni/ALEAPP/releases/tag/v3.4.0" rel="nofollow">aleappGUI v3.4.0</a>`,J=m(),j=a("hr"),K=m(),D=a("h3"),D.textContent="SANS FOR585 Poster (optional)",V=m(),P=a("p"),P.innerHTML='Download: <a href="https://web.archive.org/web/20180629023352/https://www.sans.org/security-resources/posters/dfir-advanced-smartphone-forensics/30/download" rel="nofollow">[Internet Archive Mirror]</a>',X=m(),N=a("hr"),c=m(),k=a("h3"),k.textContent="Magnet Acquire (optional)",fe=m(),le=a("blockquote"),le.innerHTML="<p>Acquire is a tool to create forensic images of iOS and Android devices, as well as hard drives and other storage mediums</p>",re=m(),se=a("p"),se.innerHTML=`The image of the Google Pixel 6 Pro phone has already been acquired so this is not required for the lab.<br/>
However if you wish to try out the program in your own time you may download it <a href="https://www.magnetforensics.com/dl/acquire" rel="nofollow">here</a> (Windows only)`},m(d,M){l(d,e,M),l(d,s,M),l(d,f,M),l(d,o,M),l(d,r,M),l(d,n,M),l(d,b,M),l(d,u,M),l(d,_,M),l(d,h,M),l(d,w,M),l(d,y,M),l(d,L,M),l(d,v,M),l(d,T,M),l(d,x,M),l(d,E,M),l(d,F,M),l(d,Q,M),l(d,R,M),l(d,$,M),l(d,G,M),l(d,q,M),l(d,z,M),l(d,W,M),l(d,Z,M),l(d,O,M),l(d,U,M),l(d,C,M),l(d,Y,M),l(d,I,M),l(d,J,M),l(d,j,M),l(d,K,M),l(d,D,M),l(d,V,M),l(d,P,M),l(d,X,M),l(d,N,M),l(d,c,M),l(d,k,M),l(d,fe,M),l(d,le,M),l(d,re,M),l(d,se,M)},p:S,i:S,o:S,d(d){d&&i(e),d&&i(s),d&&i(f),d&&i(o),d&&i(r),d&&i(n),d&&i(b),d&&i(u),d&&i(_),d&&i(h),d&&i(w),d&&i(y),d&&i(L),d&&i(v),d&&i(T),d&&i(x),d&&i(E),d&&i(F),d&&i(Q),d&&i(R),d&&i($),d&&i(G),d&&i(q),d&&i(z),d&&i(W),d&&i(Z),d&&i(O),d&&i(U),d&&i(C),d&&i(Y),d&&i(I),d&&i(J),d&&i(j),d&&i(K),d&&i(D),d&&i(V),d&&i(P),d&&i(X),d&&i(N),d&&i(c),d&&i(k),d&&i(fe),d&&i(le),d&&i(re),d&&i(se)}}}class nt extends ie{constructor(e){super(),te(this,e,null,ot,ee,{})}}function ft(t){let e,s,f,o,r;return{c(){e=a("h2"),e.textContent="Chain of Custody",s=m(),f=a("p"),f.innerHTML=`This phone was acquired by the police, and a <em>chain of custody</em> has been performed.<br/>
You’ve been provided with a journal of the phone’s acquisition.`,o=m(),r=a("ul"),r.innerHTML=`<li><strong>Device was placed in a Faraday bag</strong></li> 
<li>Flight mode was enabled</li> 
<li>SIM card was removed</li> 
<li><strong>Device was removed from the Faraday bag</strong></li> 
<li>Started <em>Magnet Acquire</em></li> 
<li>Connected phone to <em>Magnet Acquire</em></li> 
<li>Confirmed that serial number matched the serial in the <em>chain of custody</em></li> 
<li>Noted that the device was not rooted</li> 
<li>Rooted the device to allow for full system access during acquisition</li> 
<li>Created a <em>logical image</em> of the device in <em>Magnet Acquire</em></li>`},m(n,b){l(n,e,b),l(n,s,b),l(n,f,b),l(n,o,b),l(n,r,b)},p:S,i:S,o:S,d(n){n&&i(e),n&&i(s),n&&i(f),n&&i(o),n&&i(r)}}}class rt extends ie{constructor(e){super(),te(this,e,null,ft,ee,{})}}function ut(t){let e,s,f;return{c(){e=a("h2"),e.textContent="Part Zero",s=m(),f=a("p"),f.textContent="Hashsum verification. Do it."},m(o,r){l(o,e,r),l(o,s,r),l(o,f,r)},p:S,i:S,o:S,d(o){o&&i(e),o&&i(s),o&&i(f)}}}class at extends ie{constructor(e){super(),te(this,e,null,ut,ee,{})}}function dt(t){let e,s,f,o,r,n,b;return{c(){e=a("h2"),e.textContent="SMS Messages",s=m(),f=a("p"),f.innerHTML=`It is suspected that the owner of the phone was about to strike a deal for some fruit.<br/>
This suggests that some sort of communication would have been done, and so it would be wise as a forensics investigator to first start looking at SMS messages, as well as other messaging services / applications`,o=m(),r=a("p"),r.innerHTML=`The locations of SMS messages can differ depending on the phone model, Android OS version, and SMS application.<br/>
In the Android phone image provided, SMS messages can be found in <code>/data/com.android.providers.telephony/databases/mmssms.db</code>.`,n=m(),b=a("p"),b.innerHTML='<img src="images/Snipaste_2023-07-16_01-31-21.png"/>'},m(u,_){l(u,e,_),l(u,s,_),l(u,f,_),l(u,o,_),l(u,r,_),l(u,n,_),l(u,b,_)},p:S,i:S,o:S,d(u){u&&i(e),u&&i(s),u&&i(f),u&&i(o),u&&i(r),u&&i(n),u&&i(b)}}}class pt extends ie{constructor(e){super(),te(this,e,null,dt,ee,{})}}function ct(t){let e,s,f,o,r,n,b,u,_,h,w,y,L,v,T,x,E,F,Q,R,$,G,q,z,W,Z,O,U,C,Y,I,J,j,K,D,V,P,X,N,c,k,fe,le,re,se,d,M;return{c(){e=a("h2"),e.textContent="Database analysis of SMS messages",s=m(),f=a("p"),f.innerHTML='<img src="images/Snipaste_2023-07-16_01-34-40.png"/>',o=m(),r=a("p"),r.textContent="Generally, with any database analysis task - we should first review the database schema - as it will help assist us in navigating the structure, and provide insight into how the application developer has laid out their data.",n=m(),b=a("hr"),u=m(),_=a("p"),_.innerHTML='<img src="images/Snipaste_2023-07-16_01-38-31.png"/>',h=m(),w=a("p"),w.textContent="We can then browse the data in the database tables",y=m(),L=a("hr"),v=m(),T=a("p"),T.innerHTML="If we look at the <code>threads</code> table, we can also see all the different conversations that phone was active in.",x=m(),E=a("p"),E.innerHTML='<img src="images/Snipaste_2023-07-16_01-53-14.png"/>',F=m(),Q=a("hr"),R=m(),$=a("p"),$.innerHTML="As with SQL databases, all SMS messages will be stored in the same table - meaning that in order to view messages of a particular thread, we will need to filter the messages based off a key - e.g. <code>thread_id</code>",G=m(),q=a("blockquote"),q.innerHTML="<p>sqlite&gt; <code>SELECT address, body AS messages, datetime(date/1000, &#39;unixepoch&#39;, &#39;localtime&#39;) AS dates FROM sms WHERE thread_id=&#39;3&#39;</code></p>",z=m(),W=a("p"),W.innerHTML='<img src="images/Snipaste_2023-07-16_01-50-53.png"/>',Z=m(),O=a("hr"),U=m(),C=a("blockquote"),C.innerHTML="<p>How many messages were retrieved from the above SQL query?</p>",Y=m(),I=a("blockquote"),I.innerHTML="<p>What’s the value of <code>message_count</code> for that <code>thread_id</code> in the <code>threads</code> table?</p>",J=m(),j=a("p"),j.innerHTML="For <code>thread_id=3</code>, the SQL query returned 11 messages, however according to the <code>threads</code> table, <code>message_count=17</code> for thread 3… This flags that there is likely some deleted messages in the thread!",K=m(),D=a("hr"),V=m(),P=a("h3"),P.textContent="Deleted files?",X=m(),N=a("p"),N.innerHTML="Oh I know, look at the <s>recycle bin</s> or the <s>unallocated space</s>.",c=m(),k=a("ul"),k.innerHTML=`<li>A recycle bin only exists if both the application and system supports such functionality</li> 
<li>Unallocated space is only captured in an image if a physical image acquisition (bit for bit) was performed</li>`,fe=m(),le=a("p"),le.textContent="As a logical image was acquired and provided, no unallocated space was captured - only space where files actually are registered to exist.",re=m(),se=a("p"),se.innerHTML="<strong><em>But interestingly, databases don’t really delete data..</em></strong>",d=m(),M=a("blockquote"),M.innerHTML="<p>Big data, or something idk.</p>"},m(p,A){l(p,e,A),l(p,s,A),l(p,f,A),l(p,o,A),l(p,r,A),l(p,n,A),l(p,b,A),l(p,u,A),l(p,_,A),l(p,h,A),l(p,w,A),l(p,y,A),l(p,L,A),l(p,v,A),l(p,T,A),l(p,x,A),l(p,E,A),l(p,F,A),l(p,Q,A),l(p,R,A),l(p,$,A),l(p,G,A),l(p,q,A),l(p,z,A),l(p,W,A),l(p,Z,A),l(p,O,A),l(p,U,A),l(p,C,A),l(p,Y,A),l(p,I,A),l(p,J,A),l(p,j,A),l(p,K,A),l(p,D,A),l(p,V,A),l(p,P,A),l(p,X,A),l(p,N,A),l(p,c,A),l(p,k,A),l(p,fe,A),l(p,le,A),l(p,re,A),l(p,se,A),l(p,d,A),l(p,M,A)},p:S,i:S,o:S,d(p){p&&i(e),p&&i(s),p&&i(f),p&&i(o),p&&i(r),p&&i(n),p&&i(b),p&&i(u),p&&i(_),p&&i(h),p&&i(w),p&&i(y),p&&i(L),p&&i(v),p&&i(T),p&&i(x),p&&i(E),p&&i(F),p&&i(Q),p&&i(R),p&&i($),p&&i(G),p&&i(q),p&&i(z),p&&i(W),p&&i(Z),p&&i(O),p&&i(U),p&&i(C),p&&i(Y),p&&i(I),p&&i(J),p&&i(j),p&&i(K),p&&i(D),p&&i(V),p&&i(P),p&&i(X),p&&i(N),p&&i(c),p&&i(k),p&&i(fe),p&&i(le),p&&i(re),p&&i(se),p&&i(d),p&&i(M)}}}class mt extends ie{constructor(e){super(),te(this,e,null,ct,ee,{})}}function bt(t){let e,s,f,o,r,n,b,u,_,h,w,y,L,v,T,x,E,F,Q,R,$,G,q,z,W,Z,O,U,C,Y,I,J,j,K,D,V,P,X,N;return{c(){e=a("h2"),e.textContent="Deleted SMS records",s=m(),f=a("p"),f.textContent="On an Android device there are several locations in a file system extraction that can yield deleted text messages",o=m(),r=a("ul"),r.innerHTML=`<li>e.g. the SMS Database</li> 
<li>e.g. the SMS Journal</li>`,n=m(),b=a("p"),b.innerHTML=`Generally SQLite databases retain deleted data until they are compressed.<br/>
On some phones there is a setting to automatically compress the database, however it varies.`,u=m(),_=a("p"),_.textContent="Whilst the database is not yet compressed, deleted data lingers around in the database file but are no longer linked to the database structure.",h=m(),w=a("hr"),y=m(),L=a("p"),L.textContent="Before we start looking for deleted messages let’s first have a read of the below blog post, and understand how messages are stored in the SQLite database at a byte level.",v=m(),T=a("blockquote"),T.innerHTML='<p><a href="http://az4n6.blogspot.com/2013/02/finding-and-reverse-engineering-deleted_1865.html" rel="nofollow">http://az4n6.blogspot.com/2013/02/finding-and-reverse-engineering-deleted_1865.html</a></p>',x=m(),E=a("p"),E.innerHTML='See if you can find any data that you didn’t see in the SQLite Browser. We recommend to use <a href="https://mh-nexus.de/en/hxd/" rel="nofollow">HxD</a> on Windows.',F=m(),Q=a("hr"),R=m(),$=a("h3"),$.textContent="Write Ahead Logging",G=m(),q=a("p"),q.innerHTML="To mitigate the event of catastrophic data failure (i.e. corruption due to a power loss or disconnection), certain systems implement something known a <em>journal</em>, or <em>commit log</em> - where changes to be made in a database are recorded on another file before the actual modification is made. This way, in the event of a write event failing, a history of changes can be replayed to ensure that the modification will eventually be applied in the database.",z=m(),W=a("p"),W.textContent="In SQLite databases, a Write Ahead Log can be used to provide similar methods of redunancy…",Z=m(),O=a("blockquote"),O.innerHTML=`<p><em>The traditional rollback journal works by writing a copy of the original unchanged database content into a separate rollback journal file and then writing changes directly into the database file. In the event of a crash or ROLLBACK, the original content contained in the rollback journal is played back into the database file to revert the database file to its original state. The COMMIT occurs when the rollback journal is deleted.</em></p> 
<p><em>The WAL approach inverts this. The original content is preserved in the database file and the changes are appended into a separate WAL file. A COMMIT occurs when a special record indicating a commit is appended to the WAL. Thus a COMMIT can happen without ever writing to the original database, which allows readers to continue operating from the original unaltered database while changes are simultaneously being committed into the WAL. Multiple transactions can be appended to the end of a single WAL file.</em></p> 
<p><em>Source: <a href="https://www.sqlite.org/wal.html" rel="nofollow">https://www.sqlite.org/wal.html</a></em></p>`,U=m(),C=a("p"),C.innerHTML="The contents of the WAL are periodically moved to the DB file but this is not guaranteed to occur each time the process exits. Therefore, when WAL is enabled - each SQLite DB consists of two files on disk that must be preserved, both the <code>.db</code> file and the <code>.db-wal</code> file.",Y=m(),I=a("p"),I.innerHTML='It’s also worthwhile to read this blog: <a href="https://digitalinvestigation.wordpress.com/2012/05/04/the-forensic-implications-of-sqlites-write-ahead-log/" rel="nofollow">The Forensic Implications of SQLite’s Write Ahead Log</a>',J=m(),j=a("hr"),K=m(),D=a("blockquote"),D.innerHTML='<p>An extraction of the Android Messages WAL from the device can be found <a href="https://featherbear.cc/UNSW-COMP6845-android-aleapp/SQLite%20Journaling/11_bugle_db-wal.txt" rel="nofollow">here</a></p>',V=m(),P=a("p"),P.innerHTML='<img src="images/Snipaste_2023-07-16_02-32-33.png"/>',X=m(),N=a("p"),N.innerHTML=`Extracting dates and times from the WAL file is a complicated process and will not be covered in the tutorial.<br/>
If you want to learn more, read <a href="https://askclees.com/2020/10/11/timelining-using-sqlite-write-ahead-logs/" rel="nofollow">Timelining using SQLite Write Ahead Logs</a>`},m(c,k){l(c,e,k),l(c,s,k),l(c,f,k),l(c,o,k),l(c,r,k),l(c,n,k),l(c,b,k),l(c,u,k),l(c,_,k),l(c,h,k),l(c,w,k),l(c,y,k),l(c,L,k),l(c,v,k),l(c,T,k),l(c,x,k),l(c,E,k),l(c,F,k),l(c,Q,k),l(c,R,k),l(c,$,k),l(c,G,k),l(c,q,k),l(c,z,k),l(c,W,k),l(c,Z,k),l(c,O,k),l(c,U,k),l(c,C,k),l(c,Y,k),l(c,I,k),l(c,J,k),l(c,j,k),l(c,K,k),l(c,D,k),l(c,V,k),l(c,P,k),l(c,X,k),l(c,N,k)},p:S,i:S,o:S,d(c){c&&i(e),c&&i(s),c&&i(f),c&&i(o),c&&i(r),c&&i(n),c&&i(b),c&&i(u),c&&i(_),c&&i(h),c&&i(w),c&&i(y),c&&i(L),c&&i(v),c&&i(T),c&&i(x),c&&i(E),c&&i(F),c&&i(Q),c&&i(R),c&&i($),c&&i(G),c&&i(q),c&&i(z),c&&i(W),c&&i(Z),c&&i(O),c&&i(U),c&&i(C),c&&i(Y),c&&i(I),c&&i(J),c&&i(j),c&&i(K),c&&i(D),c&&i(V),c&&i(P),c&&i(X),c&&i(N)}}}class _t extends ie{constructor(e){super(),te(this,e,null,bt,ee,{})}}function wt(t){let e,s,f,o,r,n,b,u,_;return{c(){e=a("h2"),e.textContent="Automated Analysis with ALEAPP",s=m(),f=a("p"),f.textContent="Whilst manually trawling through the file system and known database files has its advantages, it is much more worthwhile (for the sake of timeboxing your investigation) to use scripts and tools to automate the repetitive steps.",o=m(),r=a("hr"),n=m(),b=a("p"),b.innerHTML=`<a href="https://github.com/abrignoni/ALEAPP" rel="nofollow">ALEAPP (Android Logs Events And Protobuf Parser)</a> is a tool that performs a suite of analysis processes on Android images.<br/>
It generates a report (as a webpage) with all of the process results.`,u=m(),_=a("p"),_.innerHTML='If you’d like to use ALEAPP to process the provided logical extraction yourself, you may refer to <a href="https://www.arcpointforensics.com/news/getting-started-with-aleapp" rel="nofollow">these instructions</a>.'},m(h,w){l(h,e,w),l(h,s,w),l(h,f,w),l(h,o,w),l(h,r,w),l(h,n,w),l(h,b,w),l(h,u,w),l(h,_,w)},p:S,i:S,o:S,d(h){h&&i(e),h&&i(s),h&&i(f),h&&i(o),h&&i(r),h&&i(n),h&&i(b),h&&i(u),h&&i(_)}}}class ht extends ie{constructor(e){super(),te(this,e,null,wt,ee,{})}}const ae=[["Resources",nt],["Chain Of Custody",rt],["Getting Started",at],["SMS",pt],["Database Analysis",mt],["Deleted Database Records",_t],["Automated Analysis",ht]];const{window:yt}=Fe;function Oe(t,e,s){const f=t.slice();return f[9]=e[s][0],f[10]=e[s][1],f}function vt(t){let e,s,f,o,r,n;function b(w){t[6](w)}let u={items:ae};t[1]!==void 0&&(u.activeItem=t[1]),e=new st({props:u}),we.push(()=>Xe(e,"activeItem",b));var _=t[1];function h(w){return{props:{}}}return _&&(r=Me(_,h()),t[7](r)),{c(){_e(e.$$.fragment),f=m(),o=a("main"),r&&_e(r.$$.fragment),oe(o,"class","svelte-ck21ns")},m(w,y){de(e,w,y),l(w,f,y),l(w,o,y),r&&de(r,o,null),t[8](o),n=!0},p(w,y){const L={};!s&&y&2&&(s=!0,L.activeItem=w[1],Je(()=>s=!1)),e.$set(L);const v={};if(y&2&&_!==(_=w[1])){if(r){ke();const T=r;g(T.$$.fragment,1,0,()=>{pe(T,1)}),Ae()}_?(r=Me(_,h()),w[7](r),_e(r.$$.fragment),B(r.$$.fragment,1),de(r,o,null)):r=null}else _&&r.$set(v)},i(w){n||(B(e.$$.fragment,w),r&&B(r.$$.fragment,w),n=!0)},o(w){g(e.$$.fragment,w),r&&g(r.$$.fragment,w),n=!1},d(w){pe(e,w),w&&i(f),w&&i(o),t[7](null),r&&pe(r),t[8](null)}}}function Lt(t){let e,s,f=ae,o=[];for(let n=0;n<f.length;n+=1)o[n]=De(Oe(t,f,n));const r=n=>g(o[n],1,1,()=>{o[n]=null});return{c(){for(let n=0;n<o.length;n+=1)o[n].c();e=$e()},m(n,b){for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(n,b);l(n,e,b),s=!0},p(n,b){if(b&0){f=ae;let u;for(u=0;u<f.length;u+=1){const _=Oe(n,f,u);o[u]?(o[u].p(_,b),B(o[u],1)):(o[u]=De(_),o[u].c(),B(o[u],1),o[u].m(e.parentNode,e))}for(ke(),u=f.length;u<o.length;u+=1)r(u);Ae()}},i(n){if(!s){for(let b=0;b<f.length;b+=1)B(o[b]);s=!0}},o(n){o=o.filter(Boolean);for(let b=0;b<o.length;b+=1)g(o[b]);s=!1},d(n){Re(o,n),n&&i(e)}}}function De(t){let e,s,f;var o=t[10];function r(n){return{}}return o&&(e=Me(o,r())),{c(){e&&_e(e.$$.fragment),s=$e()},m(n,b){e&&de(e,n,b),l(n,s,b),f=!0},p(n,b){if(o!==(o=n[10])){if(e){ke();const u=e;g(u.$$.fragment,1,0,()=>{pe(u,1)}),Ae()}o?(e=Me(o,r()),_e(e.$$.fragment),B(e.$$.fragment,1),de(e,s.parentNode,s)):e=null}},i(n){f||(e&&B(e.$$.fragment,n),f=!0)},o(n){e&&g(e.$$.fragment,n),f=!1},d(n){n&&i(s),e&&pe(e,n)}}}function Mt(t){let e,s,f,o,r,n,b,u,_,h;e=new tt({});const w=[Lt,vt],y=[];function L(v,T){return v[0]?0:1}return r=L(t),n=y[r]=w[r](t),{c(){_e(e.$$.fragment),s=m(),f=a("hr"),o=m(),n.c(),b=$e()},m(v,T){de(e,v,T),l(v,s,T),l(v,f,T),l(v,o,T),y[r].m(v,T),l(v,b,T),u=!0,_||(h=qe(yt,"hashchange",t[4]),_=!0)},p(v,[T]){let x=r;r=L(v),r===x?y[r].p(v,T):(ke(),g(y[x],1,1,()=>{y[x]=null}),Ae(),n=y[r],n?n.p(v,T):(n=y[r]=w[r](v),n.c()),B(n,1),n.m(b.parentNode,b))},i(v){u||(B(e.$$.fragment,v),B(n),u=!0)},o(v){g(e.$$.fragment,v),g(n),u=!1},d(v){pe(e,v),v&&i(s),v&&i(f),v&&i(o),y[r].d(v),v&&i(b),_=!1,h()}}}function kt(t,e,s){let f=!1,o=ae[0][1];function r(){var y;s(0,f=location.hash=="#all"),s(1,o=((y=ae[Number(location.hash.slice(1))])==null?void 0:y[1])||ae[0][1])}r();let n,b,u=!0;function _(y){o=y,s(1,o)}function h(y){we[y?"unshift":"push"](()=>{b=y,s(3,b)})}function w(y){we[y?"unshift":"push"](()=>{n=y,s(2,n)})}return t.$$.update=()=>{t.$$.dirty&3&&!f&&(location.hash=String(ae.findIndex(([y,L])=>L===o))),t.$$.dirty&45&&b&&n&&(n.querySelectorAll("blockquote").forEach(y=>{y.textContent.startsWith("$> ")&&(y.style.userSelect="none",y.style.setProperty("--leftLineColour","#21b0d7")),y.textContent.startsWith("splunk> ")&&(y.style.userSelect="none",y.style.setProperty("--leftLineColour","#5cbf5c"))}),f||(u?s(5,u=!1):setTimeout(()=>window.scrollTo(0,n.offsetTop-50),0)))},[f,o,n,b,r,u,_,h,w]}class At extends ie{constructor(e){super(),te(this,e,kt,Mt,ee,{})}}new At({target:document.getElementById("app")});
